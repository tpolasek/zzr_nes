
    /*
    pub fn run_test_suite_a(&mut self){
        //self.debugger_mode();

        // https://github.com/Klaus2m5/6502_65C02_functional_tests
        self.reset_state();
        self.cpu.pc = 0x400;

        let file_path = String::from("roms/6502_functional_test.bin");
        self.cpu.bus.rom.load_bin_file(&file_path);

        let ten_millis = time::Duration::from_millis(10);
        let now = time::Instant::now();


        for index in 0..100_000 {
            //thread::sleep(ten_millis);
            self.cpu.tick();
        }


        for addr in 0..20 {
            self.cpu.tick();
           //thread::sleep(ten_millis);
        }

        self.cpu.bus.print_ram(0x0200, 0xff);
    }

    pub fn test_stack(& mut self){
        self.reset_state();
        self.cpu.pc = 0x0600;
        self.cpu.bus.rom.load_hex_dump(0x0600,"0600: a2 00 a0 00 8a 99 00 02 48 e8 c8 c0 10 d0 f5 68 99 00 02 c8 c0 20 d0 f7" );
        self.cpu.run_until_interrupt();

        for i in 0..=0xf{
            assert!(self.cpu.bus.read_ram(0x200 + i) == i as u8);
        }
        for i in 0..0xf{
            assert!(self.cpu.bus.read_ram(0x210 + i) == (0xf-i) as u8);
        }
        //self.cpu.bus.print_ram(0x200, 0xff);
    }

    pub fn test_loop_performance(& mut self, loop_count : u32){
        self.reset_state();
        self.cpu.pc = 0x0600;
        self.cpu.bus.rom.load_hex_dump(0x0600, "0600: a2 00 a0 00 a9 00 e8 c8 69 01 18 90 f9" );
        let start = Instant::now();
        for addr in 0..loop_count {
            self.cpu.tick();
        }

        let elapsed = start.elapsed();
        println!("Ms: {}ms", elapsed.as_millis());
        println!("Clock speed: {}mhz", ((loop_count as f32) / (elapsed.as_millis() as f32) / 1000 as f32));
    }

    pub fn test_cycle_cost_with_page_jump(& mut self){
        /*
        LDA #$02
        STA $0201
        TAX
        ADC $01FF,X
        TAX
        ADC $01FF,X
        LDA #$00
        */
        self.reset_state();
        self.cpu.pc = 0x0600;
        self.cpu.bus.rom.load_hex_dump(0x0600, "0600: a9 02 8d 01 02 aa 7d ff 01 aa 7d ff 01 a9 00 " );

        self.cpu.tick();
        self.cpu.tick();
        assert!(!self.cpu.flag.get_flag_z());
        assert!(!self.cpu.flag.get_flag_n());
        assert!(self.cpu.reg_a == 2);

        assert!(self.cpu.bus.read_ram(0x0201) == 0);

        // STA $0201
        self.cpu.tick();
        self.cpu.tick();
        self.cpu.tick();
        assert!(self.cpu.bus.read_ram(0x0201) == 2);
        assert!(self.cpu.reg_x == 0);

        //TAX
        self.cpu.tick();
        self.cpu.tick();
        assert!(self.cpu.reg_x == 2);

        // ADC $01FF,X  --- 5 cycles because page jump
        self.cpu.tick();
        self.cpu.tick();
        self.cpu.tick();
        self.cpu.tick();
        self.cpu.tick();
        assert!(self.cpu.reg_a == 4);

        //TAX
        self.cpu.tick();
        self.cpu.tick();
        assert!(self.cpu.reg_x == 4);

        // ADC $01FF,X  --- 4 cycles no page jump
        self.cpu.tick();
        self.cpu.tick();
        self.cpu.tick();
        self.cpu.tick();
        self.cpu.tick();
        assert!(self.cpu.reg_a == 4);

        //    LDA #$00
        self.cpu.tick();
        self.cpu.tick();
        assert!(self.cpu.reg_a == 0);
    }
    */